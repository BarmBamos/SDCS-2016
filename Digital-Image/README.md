# 数字图像处理

---

## 数字图像基础

### 采样与量化

一幅图像的x和y坐标及幅度都可能是连续的，为了把它转化为数字形式，必须在坐标和幅度上都进行取样操作。数字化坐标值是采样，数字化幅度值是量化。

当我们取某幅图片某行数据时，会得到连续的灰度值曲线，其中随机变化由噪声引起。再对该行数据进行分段，每个小段就是取样位置，对曲线的值进行离散化到特定分级中，每个灰度级赋予一个特定值，如量化到256个灰度级。

从图像定点开始逐行进行执行这一过程就能产生一幅二维数字图像。

#### 数字图像表示

假设完成数字图像采样和量化工作，则会得到一个M×N的矩阵，矩阵每个点对应一个灰度值。除此之外，还可以用二维离散亮度函数f(x, y)表示，其中x和y表示坐标，f(x, y)的值代表了点(x, y)处像素的灰度值。

#### 数字图像存储

灰度典型的取值是２的整数次幂，即L=2<sup>k</sup>。离散灰度值是等间隔的并且是区间[0, L - 1]内的整数，灰度取值范围又称为动态范围。假设数字b是存储数字图像的比特数，则b=M×N×k。

#### 上采样

上采样简而言之就是图像放大，执行放大需要两个步骤，创立新的像素位置和对这些新位置像素赋灰度值。当图像整数倍放大时，最简单的就是像素的方法，复制最近的一行灰度值。

#### 下采样

用于图像缩小，最常见的是隔行保留。可以通过左乘或者右乘矩阵得到。

### 相邻像素

1. 4邻域

	用N<sub>4</sub>(p)表示像素p的４邻域，它们的坐标为(x+1, y), (x-1, y), (x, y+1), (x, y-1)。
	
	像素点p,q，若q在N<sub>4</sub>(p)中，则这两个像素４连通。
	
2. D邻域

	用N<sub>d</sub>(p)来表示，它们的坐标为(x-1, y+1), (x-1, y-1), (x+1, y+1), (x+1, y-1)。
	
3. 8邻域

	用N<sub>8</sub>(p)表示，N<sub>8</sub>(p)=N<sub>4</sub>(p)+N<sub>d</sub>(p)。
	
### 像素连通性

像素连通必要条件：

1. 两个像素位置是否相邻

2. 两个像素点的灰度值满足某种相似准则（值域V）

	用Ｖ定义邻接性像素的灰度集合，Ｖ可能是0-255中任何一个子集。

1. 4邻接

	若q在N<sub>4</sub>(p)中，则具有Ｖ中数值的p和q是４邻接的。
2. 8邻接

	若q在N<sub>8</sub>(p)中，则具有Ｖ中数值的p和q是8邻接的。
	
3. m邻接

	若q在N<sub>4</sub>(p)中，或者q在N<sub>D</sub>(p)中且N<sub>4</sub>(q)与N<sub>4</sub>(p)没有Ｖ值的像素，则具有V值的像素p和q是m邻接的。
	
	在m邻接中包含了所有的4邻接情况，除此之外判断D邻域中属于V的点，若彼此４邻域交集不含V点，则p和q是m邻接的。
	
### 通路

讨论邻接问题主要是为了寻找图像中通路（边缘），若有(x<sub>0</sub>, y<sub>0</sub>)......(x<sub>n</sub>, y<sub>n</sub>)邻接，则起点p和终点q形成通路，具体是什么通路和邻接方式有关。n为路径长度。
	
### 距离度量
1. 欧式距离

	直角三角形斜边距离。
	
2. 街区距离
	
	横纵两方向距离差值绝对值。
	
	D<sub>4</sub>(p, q) = |x-s| + |y-t|
	
3. 棋盘距离

	D<sub>8</sub>(p, q) = max(|x-s|, |y-t|)
	
---

## 空间域图像增强

### 直方图处理

灰度级为[0, L-1]范围的数字图像的直方图是离散函数和h(r<sub>k</sub>)=n<sub>k</sub>，其中r<sub>k</sub>是第k级灰度，n<sub>k</sub>是第k级灰度的像素个数。用n<sub>k</sub>去除像素的总个数可以得到归一化的方程，P(r<sub>k</sub>)=n<sub>k</sub>/n=n<sub>k</sub>/(M•N)，表示每个灰度级别的像素占总像素的比例。

通常一幅灰度均匀分布的图像的效果会比分布不均的图像好很多，所以我们尝试寻找一种方法能够自动对图像进行处理，使得图像的灰度能够分布更加均匀。

### 直方图均衡化

直方图均衡化具有自动化处理的优点且效果大部分情况下都很好，运用很广。主要步概念如下。

假设r被归一到区间[0, 1]中，r=0表示黑色，r=1表示白色，考虑一个离散公式对于任何一个给定的r都有:
	
- s=T®

即给定一个灰度值r都会得到一个相应的灰度值s，不过要求这个变换函数具有如下性质：

- T®为单值函数，保证反变换存在

- T®为单调函数，从而能保证从黑道白的顺序

在诸多函数中，满足上面两个条件且计算容易的函数就是概率分布分布函数了。

- s<sub>k</sub> = Sum(P<sub>r</sub>(r<sub>j</sub>))

即s<sub>k</sub>计算了从灰度值为0都灰度值为k的所有灰度的出现概率之和，显然具有单值和单调性。

所以，最终的直方图均衡化公式为：

- s<sub>k</sub> = (L-1) Sum(n<sub>k</sub>/(M•N))

之后可以将每个像素的灰度值重新映射到新的灰度s<sub>k</sub>中。

所以，总结直方图均衡化的步骤就是:

1. 统计各灰度值出现的次数。

2. 计算各灰度值占总像素数比例。

3. 计算概率分布函数T®。

4. 计算新的映射灰度值s<sub><k/sub>。

### 用算数/逻辑操作增强

算数/逻辑操作主要以像素为基础在两幅或者多幅图像间进行，最常见的有图像减法处理和图像平均处理。

#### 图像减法处理

两幅图像的差异表示为：

- g(x, y) = f(x, y) - h(x, y)

图像差异是两幅图像对应像素点的差值形成的。当两幅图差异很小时，相见的结果趋向于0。

#### 图像平均处理

假设将噪声h(x, y)加入到原始图像f(x, y)中，则形成的带噪图像g(x, y)。

- g(x, y) = f(x, y) + h(x, y)

图像平均处理的思想就是使用多张图片求平均，各个图片同一像素点求和后的值除以参与计算的图片数。这种方式叠加方式可以去除某些随机噪声，使用照片越多，噪声叠加求和后的值越趋于0。


### 空间滤波基础 

空间滤波处理主要有两类，一种是通过映射函数，将某一点的灰度值直接映射到另一个，另一种是操作是对某像素点及其周边邻域范围内多个像素点灰度值进行计算，这个邻域范围内形成的子图像又可以称为滤波器、掩模或者核。在滤波器中子图像的值是系数值，而不是像素值。

通常用m•n的滤波器进行线性滤波的形式和卷积处理的概念很相似，因此线性空间滤波处理 经常被称为掩模与图像的卷积。所以卷积模板、卷积核一词也常用于此。

实践中常用如下形式表示：

- R = h(i, j) = w<sub>1</sub>•p<sub>1</sub> + w<sub>2</sub>•p<sub>2</sub> + w<sub>3</sub>•p<sub>3</sub> + …… + w<sub>n</sub>•p<sub>n</sub>

### 平滑空间滤波

#### 平滑线性滤波器

平滑线性滤波器最大的作用就是去噪，基本的操作就是将掩膜范围内像素点做均值处理并填入f(x, y)中。当然，有些时候，中心点权重会大于周围邻域内的数值，具体调整根据需求来定，不过有一定是确定的，就是掩膜各个元素的和加起来为1。一般如果掩膜大小过大，则会导致图像大面积模糊化，反而不利。

#### 统计排序滤波器

统计滤波器是非线性空间滤波器，它的影响基于图像滤波器包围的像素区域中像素的排序，然后用统计结果决定代替中心像素的值。

最常见的统计滤波器就是中值滤波器，中值滤波器选取滤波区域内数值中点赋予给像素点。中值滤波器可以比较好地处理噪声，尤其是椒盐噪声。不过中值滤波器对于图像的模糊化程度不及平滑线性滤波器，这点也算是优点。

### 锐化空间滤波

……

---

## 频域图像增强

### 傅里叶变化和频域介绍

……

### 平滑频域滤波器

……

### 频域锐化滤波器

……

---

## 图像复原

### 图像退化/复原过程模型

……

### 噪声模型

……

### 只存在噪声的空间滤波复原

……

---

## 彩色图像处理

### 彩色基础

……

### 彩色模型                                                                                                                                                                                                                                                                                
  
……
                                                                                                                                                      
#### RGB彩色模型

#### CMY和CMYK模型

### 伪彩色处理

……

### 彩色变换

#### 补色                                                                                                                                                                                                                                                                                                
                                                                                                                                                      
---                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                                      
                                                                                                                                    


